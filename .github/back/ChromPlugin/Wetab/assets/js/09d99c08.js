"use strict";(globalThis.webpackChunkinfinity_hitab_client=globalThis.webpackChunkinfinity_hitab_client||[]).push([[1477,3668],{43670:(e,s,t)=>{t.d(s,{B:()=>i});var r=t(74003),o=t(97432);const i=new class{hasPermission=async()=>new Promise((e=>{if(!r.Pl)return chrome.permissions.contains({permissions:["system.cpu","system.memory"]},(s=>{e(s)}));e(!1)}));reqPermission=async()=>new Promise((e=>{r.Pl?e(!1):chrome.permissions.request({permissions:["system.cpu","system.memory"]},(s=>{chrome.runtime.lastError?e(!1):e(s)}))}));hasBookmarksPermission=async()=>new Promise((e=>{if(!r.Pl)return chrome.permissions.contains({permissions:["bookmarks","favicon"]},(s=>{chrome.runtime.lastError?chrome.permissions.contains({permissions:["bookmarks"]},(s=>{e(s)})):e(s)}));e(!1)}));reqBookmarksPermission=async()=>new Promise((e=>{r.Pl?e(!1):chrome.permissions.request({permissions:["bookmarks","favicon"]},(s=>{chrome.runtime.lastError?"'favicon' is not a recognized permission."==chrome.runtime.lastError.message?((0,o.useBookmarksStore)().setFavicon(!0),chrome.permissions.request({permissions:["bookmarks"]},(s=>{e(s)}))):e(!1):e(s)}))}));getCpuInfo=()=>chrome.system.cpu.getInfo();getStorageInfo=()=>chrome.system.storage.getInfo();getMemoryInfo=()=>chrome.system.memory.getInfo()}},97432:(e,s,t)=>{t.r(s),t.d(s,{useBookmarksStore:()=>l});var r=t(43670),o=t(28850),i=t(10435),a=t(87322);const n=async(e,s)=>{await chrome.bookmarks.move(e,s)},m=async e=>{await(0,a.stopBrowserListening)(),await Promise.all(e.map((async e=>{await(async e=>{await chrome.bookmarks.remove(e)})(e)}))),await(0,a.startBrowserListening)()};var c=t(81220);const l=(0,i.Q_)(o.BU.bookmarks,{syncStorage:{watch:["isFirst","bookmarks","flattenBookmarks","folderList","needInfinityFavicon"]},state:()=>({isFullScreen:!1,isFirst:!0,modalShow:!1,hasPermission:!1,bookmarks:[],flattenBookmarks:[],folderList:[],needInfinityFavicon:!1}),actions:{setModal(e){this.modalShow=e},setBookmarks(e){this.bookmarks=e},setIsFirst(e){this.isFirst=e},setIsFullScreen(e){this.isFullScreen=e},async getAllData(){if(this.hasPermission=await r.B.hasBookmarksPermission(),!this.hasPermission)return;const[e,s,t]=await(0,c.jl)();this.bookmarks=e,this.flattenBookmarks=s,this.folderList=t},setFaviconById(e,s){this.bookmarks=[...(0,c.Ob)(this.bookmarks,s,{favicon:e})],this.flattenBookmarks=(0,c.Qj)(this.bookmarks),this.folderList=(0,c.Ln)(this.flattenBookmarks)},async reqPermission(){return this.hasPermission=await r.B.reqBookmarksPermission(),this.hasPermission},async batchMoveBookmark(e,s){await(async(e,s)=>{await(0,a.stopBrowserListening)(),await Promise.all(e.map((async e=>{await n(e,s)}))),await(0,a.startBrowserListening)()})(e,s),this.getAllData()},async batchRemoveBookmark(e){await m(e),this.getAllData()},async updateBookmark(e,s){await(async(e,s)=>{await(0,a.stopBrowserListening)(),await chrome.bookmarks.update(e,s),await(0,a.startBrowserListening)()})(e,{title:s.title,url:s.url}),s.parentId&&await n(e,{parentId:s.parentId}),this.getAllData()},setFavicon(e){this.needInfinityFavicon=e}}})},87322:(e,s,t)=>{t.r(s),t.d(s,{startBrowserListening:()=>m,stopBrowserListening:()=>c});var r=t(43670),o=t(97432);const i=(e,s)=>{(0,o.useBookmarksStore)().getAllData()},a=(e,s)=>{(0,o.useBookmarksStore)().getAllData()},n=(e,s)=>{(0,o.useBookmarksStore)().getAllData()},m=async()=>{await r.B.hasBookmarksPermission()&&(chrome.bookmarks.onCreated.addListener(i),chrome.bookmarks.onChanged.addListener(a),chrome.bookmarks.onRemoved.addListener(n))},c=async()=>{await r.B.hasBookmarksPermission()&&(chrome.bookmarks.onCreated.removeListener(i),chrome.bookmarks.onChanged.removeListener(a),chrome.bookmarks.onRemoved.removeListener(n))}},81220:(e,s,t)=>{t.d(s,{GR:()=>m,Ln:()=>a,Ob:()=>n,Qj:()=>i,jl:()=>o});var r=t(45844);const o=async()=>{const e=await chrome.bookmarks.getTree(),s=c(e);return[e,s,a(s)]},i=e=>c(e),a=e=>e.filter((e=>{var s;return"0"!=e.id&&e.children&&(null===(s=m(e))||void 0===s?void 0:s.length)>0})),n=(e,s,t)=>{const o=(0,r.Z)(e);return o.forEach(((e,s)=>t=>{const r=t=>{t.id===e?Object.assign(t,s):t.children&&t.children.forEach(r)};return r(t)})(s,t)),o},m=e=>{var s;return e?null===(s=e.children)||void 0===s?void 0:s.filter((e=>e.url)):[]};function c(e,s){return e.reduce(((e,t)=>(e.push({id:t.id,parentId:(null==s?void 0:s.id)||"",title:t.title,url:t.url,children:t.children,index:t.index}),t.children&&e.push(...c(t.children,t)),e)),[])}},12282:(e,s,t)=>{t.d(s,{VP:()=>a,qf:()=>o,yg:()=>m});var r=t(44482);const o=30,i=-10,a=(e,s,t)=>{n(e,s,t)},n=function(e,s,t){const a=[...t].reverse(),n=e.width,m=e.height,c=e.clientWidth;s.clearRect(0,0,n,m);const l=n- -20,h=m-20;if(0===a.length)return;e.style.transition="none",e.style.transform=`translateX(${c/o}px)`;const k=s.createLinearGradient(0,0,0,m);k.addColorStop(0,"rgba(219, 63, 59, 1)"),k.addColorStop(.5,"rgba(145, 95, 252, 1)"),k.addColorStop(1,"rgba(74, 207, 255, 1)"),s.strokeStyle=k,s.lineWidth=2;const u=h/100,d=l/o,y=.1;s.beginPath(),a.forEach(((e,t)=>{const o=l-(0,r.Z)((t-1)*d)+i,n=h-(0,r.Z)(a[t-1]*u)+10,m=l-(0,r.Z)((t-2)*d)+i,c=h-(0,r.Z)(a[t-2]*u)+10,k=l-(0,r.Z)(t*d)+i,g=h-(0,r.Z)(e*u)+10,p=l-(0,r.Z)((t+1)*d)+i,v=h-(0,r.Z)(a[t+1]*u)+10;let w=o+(k-m)*y,P=n+(g-c)*y,f=k-(p-o)*y,b=g-(v-n)*y;0!==t?(1===t?(w=o+(k-0)*y,P=n+(g-200)*y):t===a.length-1&&(f=k-(k-o)*y,b=g-(g-n)*y),s.bezierCurveTo(w,P,f,b,k,g)):s.lineTo(k,g)})),s.stroke(),requestAnimationFrame((()=>{e.style.transition="transform 0.8s",e.style.transform="none"}))};const m=new class{setPrevCPU(e){this.prevCPUTime=e}getPrevCPU(){return this.prevCPUTime}getUsedList(e){let s;const t=[];return e.processors.forEach(((e,r)=>{const o=e.usage;if(this.getPrevCPU()){const e=this.getPrevCPU().processors[r].usage;s=Math.floor((o.kernel+o.user-e.kernel-e.user)/(o.total-e.total)*100)}else s=Math.floor((o.kernel+o.user)/o.total*100);t.push(s)})),this.setPrevCPU(e),t}}},61477:(e,s,t)=>{t.r(s),t.d(s,{useSystemStore:()=>h});var r=t(43670),o=t(44482),i=t(34906),a=t(70642),n=t(10435),m=t(12282);let c=null,l=null;const h=(0,n.Q_)("store-system",{state:()=>({hasPermission:null,cpu:{name:"",shortName:"",usedPercent:0},cpuHistory:[],cpuInterval:1e3,memory:{available:0,total:0,usedPercent:0}}),actions:{async getMemory(){const e=await r.B.getMemoryInfo();this.memory={available:(0,o.Z)(e.availableCapacity/1024/1024/1024,2),total:(0,o.Z)(e.capacity/1024/1024/1024),usedPercent:(0,i.Z)((0,o.Z)((e.capacity-e.availableCapacity)/e.capacity*100,1),0,100)}},async getCpu(){const e=await r.B.getCpuInfo(),s=m.yg.getUsedList(e),t=(0,i.Z)((0,o.Z)((0,a.Z)(s),1),1,100),n=t>10?(0,o.Z)(t):t,c=e.modelName.match(/([0-9\.]*)ghz/gi);let l="";c&&(l=c[0]),this.cpu={name:e.modelName,shortName:l,usedPercent:n},this.cpuHistory.push(n),this.cpuHistory.length>m.qf?this.cpuHistory.shift():this.cpuHistory.length>4?this.cpuInterval=2e3:this.cpuHistory.length>8&&(this.cpuInterval=3e3)},getIntervalCpu(){c&&(window.clearTimeout(c),c=null),this.getCpu(),c=window.setTimeout((()=>{this.getIntervalCpu()}),this.cpuInterval)},getIntervalMemory(){l&&(window.clearTimeout(l),l=null),this.getMemory(),l=window.setTimeout((()=>{this.getIntervalMemory()}),3500)},async getAllData(){this.hasPermission=await r.B.hasPermission(),this.hasPermission&&(this.getIntervalCpu(),this.getIntervalMemory())},async reqPermission(){return this.hasPermission=await r.B.reqPermission(),this.hasPermission}}})}}]);