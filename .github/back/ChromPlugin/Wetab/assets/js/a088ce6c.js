"use strict";(globalThis.webpackChunkinfinity_hitab_client=globalThis.webpackChunkinfinity_hitab_client||[]).push([[7348,5143],{73186:(t,e,i)=>{i.d(e,{O9:()=>h,ST:()=>w,XM:()=>b,dJ:()=>I,f8:()=>C,hQ:()=>D,o7:()=>M,t4:()=>d,zY:()=>p});var a=i(994),o=i(80661),n=i.n(o),s=i(74003),r=i(63477),l=i(55332),c=i(27542);const h={font:["rgba(248, 248, 248, 1)","rgba(28, 28, 30, 1)","rgba(58, 58, 60, 1)","rgba(95, 95, 99, 1)","rgba(142, 142, 147, 1)","rgba(176, 176, 182, 1)","rgba(199, 199, 204, 1)"],background:["rgba(248, 248, 248, 1)","rgba(58, 58, 60, 1)","rgba(28, 28, 30, 1)","rgba(244, 171, 18, 1)","rgba(74, 197, 92, 1)","rgba(35, 207, 168, 1)","rgba(67, 133, 241, 1)","rgba(56, 100, 255, 1)","rgba(118, 33, 249, 1)","rgba(224, 78, 150, 1)","rgba(224, 78, 78, 1)","rgba(253, 90, 90, 1)","rgba(183, 163, 150, 1)","rgba(171, 131, 131, 1)","rgba(182, 150, 135, 1)","rgba(109, 131, 95, 1)","rgba(125, 171, 136, 1)","rgba(158, 172, 175, 1)","rgba(103, 124, 170, 1)"]},g=["rgba(183, 163, 150, 1)","rgba(171, 131, 131, 1)","rgba(182, 150, 135, 1)","rgba(109, 131, 95, 1)","rgba(125, 171, 136, 1)","rgba(158, 172, 175, 1)","rgba(103, 124, 170, 1)"],p=()=>(0,a.Z)(g),d=Array(20).fill(0).map(((t,e)=>{const i=`${e+1}`.padStart(2,"0");return{bgImage:{large:`${s.c1}/widget-background/background${i}_larg.jpg`,medium:`${s.c1}/widget-background/background${i}_medium.jpg`,small:`${s.c1}/widget-background/background${i}_small.jpg`},thumbnail:`${s.c1}/widget-background/background${i}.jpg`}})),u=(t,e)=>{let i=!1;t.isLeapYear()&&1===t.month()&&29===t.date()&&(i=!0);let a=(0,r.sG)(t.format(`${e}-MM-DD`));return i&&!a.isLeapYear()&&(a=a.add(-1,"day")),a.valueOf()>=x.valueOf()||(a=(0,r.sG)(t.format(`${e+1}-MM-DD`)),i&&!a.isLeapYear()&&(a=a.add(-1,"day"))),a},y=t=>{const e=l.q7.fromDate(new Date(t)),i=l.q7.fromDate(new Date).getYear(),a=n()((0,r.EJ)({year:i,month:e.getMonth(),day:e.getDay()}));return a.valueOf()>=x.valueOf()?a:n()((0,r.EJ)({year:i+1,month:e.getMonth(),day:e.getDay()}))},m=t=>{if(t.date()>=x.date())return(0,r.sG)(`${x.year()}-${x.month()+1}-${Math.min(x.daysInMonth(),t.date())}`);const e=x.add(1,"month");return(0,r.sG)(`${e.year()}-${e.month()+1}-${Math.min(e.daysInMonth(),t.date())}`)},f=t=>{const e=l.q7.fromDate(new Date),i=l.q7.fromDate(new Date(t)),a=e.getDay(),o=i.getDay();if(o>=a)return n()((0,r.EJ)({year:e.getYear(),month:e.getMonth(),day:o}));const s=l.o7.fromYm(e.getYear(),e.getMonth()).next(1);return n()((0,r.EJ)({year:s.getYear(),month:s.getMonth(),day:o}))},w=t=>{const e=Date.now(),i=n()().endOf("day").valueOf()+1;return window.setTimeout((()=>{try{t(i),w(t)}catch(t){}}),i-e)},b=t=>{const e=Date.now(),i=n()().add(30,"minute").valueOf();return window.setTimeout((()=>{try{t(i),b(t)}catch(t){}}),i-e)};let x=n()().startOf("day"),v=x.year();w((()=>{x=n()(),v=x.year()}));const I=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solar";if(!t)return 0;if(t>=x.valueOf())return n()(t).diff(x,"day");if("lunar"===e){return f(t).diff(x,"day")}const i=n()(t),a=m(i),o=a.diff(x,"day");return o},D=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solar";if(!t)return 0;if(t>=x.valueOf())return n()(t).diff(x,"day");if("lunar"===e){return y(t).diff(x,"day")}const i=n()(t),a=u(i,v),o=a.diff(x,"day");return o},C=t=>{const e=Math.floor(t/86400);t-=86400*e;const i=Math.floor(t/3600)%24;t-=3600*i;const a=Math.floor(t/60)%60;return{d:e,h:i,m:a,s:(t-=60*a)%60}};class M{views=new Map;execTime=0;execTimer=null;isPageVisible=!0;setViewVisibleInterval(){0!==this.views.size?this.isPageVisible?this.isViewVisible?this.setInterval(this.interval):this.setInterval(this.intervalOnViewOut):this.setPageVisibleInterval():this.setInterval(0)}setPageVisibleInterval(){0!==this.views.size?this.isPageVisible?this.setViewVisibleInterval():this.setInterval(this.intervalOnPageHide):this.setInterval(0)}setInterval(t){if(this.execTimer&&window.clearTimeout(this.execTimer),t<=0)return;let e=t;this.execTime&&(e=t-(Date.now()-this.execTime),e<0&&(e=0)),this.execTimer=window.setTimeout((async()=>{await this.execFn(),this.setInterval(t)}),e)}watchPageStatus(){c.Z.addEventListener("statechange",(t=>{"hidden"===t.newState?this.isPageVisible=!1:this.isPageVisible=!0,this.setPageVisibleInterval()}))}onChangeViewVisible(){let t=!1;this.views.forEach((e=>{t||(t=e)})),this.isViewVisible=t,this.setViewVisibleInterval()}initIo(){this.io=new IntersectionObserver((t=>{t.forEach((t=>{this.views.has(t.target)&&this.views.set(t.target,t.intersectionRatio>0)})),this.onChangeViewVisible()}),{threshold:[0]})}constructor(t,e){if(!e.interval)throw new Error("请设置间隔时间");this.interval=e.interval,this.intervalOnViewOut=e.intervalOnViewOut,this.intervalOnPageHide=e.intervalOnPageHide,this.execFn=async()=>{try{await t()}catch(t){}this.execTime=Date.now()},e.immediate&&this.execFn(),this.watchPageStatus(),this.initIo(),e.view&&this.addView(e.view)}addView(t){this.views.set(t,!1),this.io.observe(t)}removeView(t){this.views.delete(t),this.io.unobserve(t),this.onChangeViewVisible()}}},22854:(t,e,i)=>{i.d(e,{C:()=>n});var a=i(29445),o=i(57268);const n=(t,e,i)=>{const n=(0,a.iH)(t);e.onChangeState=t=>{n.value={...t}};const s=(0,o.Fl)((()=>i?i[n.value.size]:null));return{propsState:n,HomeComp:s}}},87348:(t,e,i)=>{i.r(e),i.d(e,{mountHome:()=>ot,widgetApp:()=>at});var a=i(29445),o=i(68398),n=i(96755),s=i(57268),r=i(45143),l=i(94209);const c=(0,s.aZ)({__name:"pie-chart",props:{pieStyle:null,percent:null},setup(t){const e=t,i=(0,a.iH)(),o=(0,a.iH)(),n=(0,a.iH)(0);function r(){window.cancelAnimationFrame(i.value);const t=e.pieStyle.size+6,a=e.pieStyle.bgColor;var s=o.value,r=s.getContext("2d");const l=2*window.devicePixelRatio;if(s.height=t*l,s.width=t*l,r.scale(l,l),e.pieStyle.showPercent){r.font="16px ali-75",r.fillStyle=a;var c=(e.percent||0).toFixed(0)+"",h=r.measureText(c);r.fillText(c,(t-h.width)/2-h.width/4,(t+h.width/2)/2),r.globalAlpha=.6,r.font="12px ali-65";r.measureText("%"),r.fillText("%",(t-h.width)/2-h.width/4+h.width,(t+h.width/2)/2)}const g=t/2,p=t/2,d=t/2-4;r.globalAlpha=.3;const u=2*Math.PI-Math.PI/2;function y(t,e,i){r.beginPath(),r.arc(g,p,d,t,e,!1),r.lineWidth=8,r.strokeStyle=i,r.lineCap="round",r.stroke(),r.closePath()}y(-Math.PI/2,u,a),i.value=requestAnimationFrame((function t(){r.globalAlpha=1;const o=-Math.PI/2;let s=o;e.percent&&(n.value<e.percent?(n.value+=.5,n.value>e.percent&&(n.value=e.percent),s=2*Math.PI*n.value/100-Math.PI/2,y(o,s,a)):(n.value=e.percent,s=2*Math.PI*e.percent/100-Math.PI/2,y(o,s,a)),n.value!=e.percent&&(i.value=requestAnimationFrame(t)))}))}return(0,s.bv)((()=>{r()})),(0,s.Ah)((()=>{window.cancelAnimationFrame(i.value)})),(0,s.YP)((()=>e.pieStyle.bgColor),(()=>{r()})),(0,s.YP)((()=>e.percent),(()=>{r()})),(t,i)=>((0,s.wg)(),(0,s.iD)("canvas",{ref_key:"canvasRef",ref:o,style:(0,l.normalizeStyle)({height:e.pieStyle.size+"px",width:e.pieStyle.size+"px"})},null,4))}});var h=i(80661),g=i.n(h);const p=(0,s.aZ)({__name:"bar-chart",props:{barStyle:null,data:null},setup(t){const e=t,i=(0,a.iH)();function o(){const t=function(){let t=0;return e.data.map((e=>{t=Math.max(e.total,t)})),e.data.map((e=>({...e,percent:e.total/t})))}(),a=e.barStyle.width,o=e.barStyle.height,n=e.barStyle.defBarColor||"#10C591";var s=i.value,r=s.getContext("2d");const l=2*window.devicePixelRatio,c=s.height=o*l,h=(s.width=a*l,24*l),p=34*l,d=12*l;function u(t){const{ctx:e,x:i,y:a,width:o,height:n,radius:s,fillColor:r}=t;if(2*s>o||2*s>n)return!1;e.save(),e.translate(i,a),function(t){const{ctx:e,width:i,height:a,radius:o}=t;e.beginPath(0),e.arc(i-o,a-o,o,0,Math.PI/2),e.lineTo(o,a),e.arc(o,a-o,o,Math.PI/2,Math.PI),e.lineTo(0,o),e.arc(o,o,o,Math.PI,3*Math.PI/2),e.lineTo(i-o,0),e.arc(i-o,o,o,3*Math.PI/2,2*Math.PI),e.lineTo(i,a-o),e.closePath()}({ctx:e,width:o,height:n,radius:s}),e.fillStyle=r||"#000",e.fill(),e.restore()}((t,e)=>{const{ht:i,pad:a,bottomPad:o,step:n,ctx:s}=e;s.beginPath(),s.lineWidth=1,s.strokeStyle="#666";for(let e=0;e<t.length;e++){s.moveTo(a+e*n,i-o);const c=12*l;s.font=`${c}px ali-65`,s.fillStyle="#FFF";var r=t[e];s.fillText(r,e*n,i-2)}s.stroke(),s.closePath(),s.closePath()})(["一","二","三","四","五","六","日"],{ht:c,pad:22*l,bottomPad:h,step:p,ctx:r}),r.beginPath();for(let e=0;e<7;e++){var y,m;const i=(null===(y=t[e])||void 0===y?void 0:y.percent)||0,a=null===(m=t[e])||void 0===m?void 0:m.time,o=i*(c-1.57*h)+.1*(c-h);u({ctx:r,x:e*p,y:c-h-o,width:d,height:o,radius:d/2,fillColor:(0==g()().day()?7:g()().day())==a?"#FFF":n})}r.closePath()}return(0,s.YP)((()=>({bgColor:e.barStyle.bgColor,data:e.data})),(()=>{o()})),(0,s.bv)((()=>{o()})),(t,a)=>((0,s.wg)(),(0,s.iD)("canvas",{ref_key:"canvasRef",ref:i,style:(0,l.normalizeStyle)({height:e.barStyle.height+"px",width:e.barStyle.width+"px"})},null,4))}});var d=i(35367),u=i(37334);const y={class:"habit-bg relative h-full bg-cover bg-center bg-no-repeat font-ali-75 transition-[background,color]"},m={class:"content relative flex h-full flex-row p-[12px] leading-none text-[#27DBA7]"},f={class:"flex h-full flex-col justify-between p-[32px] icon-m:p-[12px] icon-s:p-[4px]"},w={class:"flex flex-row"},b={class:"mt-[-6px] h-max"},x=["src"],v={class:"flex flex-row items-end"},I={class:"pb-[3px] font-ali-75 text-[12px] leading-[12px]"},D={class:"mr-[1px] text-[24px] leading-[24px]"},C=(t=>((0,s.dD)("data-v-d37652c4"),t=t(),(0,s.Cn)(),t))((()=>(0,s._)("span",{class:"pb-[2px] font-ali-75 text-[12px] leading-[12px]"},"ml",-1))),M={class:"w-[320[px] ml-[24px] flex h-full flex-1 items-center justify-center rounded-[12px] bg-[#27DBA7] icon-m:w-[280px] icon-s:w-[260px]"},S=(0,s.aZ)({__name:"habit-home-large",setup(t){const e=(0,r.useHabitStore)();return(t,i)=>((0,s.wg)(),(0,s.iD)("section",y,[(0,s._)("div",m,[(0,s._)("div",f,[(0,s._)("div",w,[(0,s.Wm)(c,{"pie-style":{...(0,a.SU)(d.tn),bgColor:"#27DBA7",showPercent:!0,size:64},percent:100*((0,a.SU)(e).percent>(0,a.SU)(e).target?1:(0,a.SU)(e).percent/(0,a.SU)(e).target)},null,8,["pie-style","percent"]),(0,s._)("button",b,[(0,s._)("img",{class:"h-[28px] w-[28px] py-[8px] px-[8px]",src:(0,a.SU)(u)},null,8,x)])]),(0,s._)("div",v,[(0,s._)("span",I,(0,l.toDisplayString)("剩余"),1),(0,s._)("span",D,(0,l.toDisplayString)((0,a.SU)(e).surplus),1),C])]),(0,s._)("div",M,[(0,s.Wm)(p,{"bar-style":{...(0,a.SU)(d.yD),height:148,width:216},data:(0,a.SU)(e).historyOfWeek},null,8,["bar-style","data"])])])]))}});var A=i(76911);const k=(0,A.Z)(S,[["__scopeId","data-v-d37652c4"]]);var P=i(45911);const O=t=>((0,s.dD)("data-v-c8fc8292"),t=t(),(0,s.Cn)(),t),T={class:"habit-bg relative h-full bg-cover bg-center bg-no-repeat transition-[background,color]"},_={class:"content relative flex h-full flex-col justify-between p-[24px] font-ali-55 leading-none text-[#27DBA7] icon-m:p-[20px] icon-s:p-[16px]"},F={class:"flex flex-row items-center justify-start"},z={class:"h-[40px] pl-[24px] icon-m:pl-[20px] icon-s:pl-[24px]"},N={class:"flex flex-row items-center font-ali-65 text-[12px] leading-[17px]"},B={class:"font-ali-75 text-[24px] leading-[24px]"},U=O((()=>(0,s._)("span",{class:"ml-[4px] text-[12px] leading-[12px]"},"ml",-1))),V={class:"mt-[58px] flex flex-wrap gap-[8px] text-[#FFF] icon-m:mt-[34px] icon-s:mt-[18px]"},j=["onClick"],W={class:"font-ali-75 text-[16px] leading-[16px]"},L=O((()=>(0,s._)("span",{class:"ml-[1px] text-[12px] leading-[12px]"},"ml",-1))),G=(0,s.aZ)({__name:"habit-home-medium",setup(t){const e=(0,r.useHabitStore)(),i=(0,P.Z)((t=>{e.drinking({capacity:t,category:d.MV.water})}),500,{leading:!0,trailing:!1});return(t,n)=>((0,s.wg)(),(0,s.iD)("section",T,[(0,s._)("div",_,[(0,s._)("div",F,[(0,s.Wm)(c,{"pie-style":{...(0,a.SU)(d.tn),bgColor:"#27DBA7"},percent:(0,a.SU)(e).percent/(0,a.SU)(e).target*100},null,8,["pie-style","percent"]),(0,s._)("div",z,[(0,s._)("p",N,(0,l.toDisplayString)("今日剩余"),1),(0,s._)("span",B,(0,l.toDisplayString)((0,a.SU)(e).surplus),1),U])]),(0,s._)("div",V,[((0,s.wg)(),(0,s.iD)(s.HY,null,(0,s.Ko)([180,250,350,480],((t,e)=>(0,s._)("div",{key:t+"_"+e,class:"history-item relative flex flex-row items-baseline justify-center rounded-[8px] p-[12px]",onClick:(0,o.withModifiers)((e=>(0,a.SU)(i)(t)),["stop"])},[(0,s._)("span",W,(0,l.toDisplayString)(t),1),L],8,j))),64))])])]))}}),Z=(0,A.Z)(G,[["__scopeId","data-v-c8fc8292"]]),H={class:"relative h-full bg-[#27DBA7] bg-cover bg-center bg-no-repeat transition-[background,color]"},E={class:"content relative flex h-full flex-row items-center px-[24px] py-[19px] font-ali-65 leading-none icon-m:px-[16px] icon-m:py-[11px] icon-s:px-[10px] icon-s:py-[5px]"},Y={class:"pl-[16px] text-[#FFF]"},Q={class:"font-ali-75 text-[24px] leading-[24px]"},$=(0,s._)("span",{class:"ml-[4px] text-[12px] leading-[12px]"},"ml",-1),R={class:"flex flex-row items-center text-[12px] leading-[17px]"},J={class:"py-[4px] px-[8px]"},K=["src"],q=(0,s.aZ)({__name:"habit-home-small",setup(t){const e=(0,r.useHabitStore)();return(t,i)=>((0,s.wg)(),(0,s.iD)("section",H,[(0,s._)("div",E,[(0,s.Wm)(c,{"pie-style":{...(0,a.SU)(d.tn),bgColor:"#FFF"},percent:(0,a.SU)(e).percent/(0,a.SU)(e).target*100},null,8,["pie-style","percent"]),(0,s._)("div",Y,[(0,s._)("span",Q,(0,l.toDisplayString)((0,a.SU)(e).surplus),1),$,(0,s._)("div",R,[(0,s.Uk)((0,l.toDisplayString)("剩余")+" ",1),(0,s._)("button",J,[(0,s._)("img",{class:"h-[12px] w-[12px] rounded-[4px] bg-color-white",src:(0,a.SU)(u)},null,8,K)])])])])]))}});var X=i(22854),tt=i(73186);const et=(0,s.aZ)({__name:"widget-habit-home",props:{size:null,widgetData:null,id:null,targetType:null},setup(t){const e=t;(0,s.bv)((()=>{l.check()}));const i={s:q,m:Z,l:k},{HomeComp:o,propsState:n}=(0,X.C)(e,at.value,i),l=(0,r.useHabitStore)(),c=()=>{const t=l.target?"edit":"preview-list"===n.value.targetType?"preview":"edit";l.openModal({size:n.value.size,openType:t,editId:n.value.id})};return(0,tt.ST)((()=>{l.check()})),(t,e)=>((0,s.wg)(),(0,s.iD)("section",{class:"contents cursor-pointer",onClick:c},[((0,s.wg)(),(0,s.j4)((0,s.LL)((0,a.SU)(o)),{state:(0,a.SU)(n).widgetData},null,8,["state"]))]))}});var it=i(75008);const at=(0,a.iH)(null),ot=(t,e)=>{const i=(0,o.createApp)(et,e);return(0,it.f)(i),at.value=i,i.use(n.M),i.mount(t),at.value}},45143:(t,e,i)=>{i.r(e),i.d(e,{useHabitStore:()=>p,widgetInfo:()=>g});var a=i(10435),o=i(35367),n=i(24581),s=i(28850),r=i(12793),l=i(80661),c=i.n(l),h=i(94119);const g=(0,n.E0)(n.Rm.habit),p=(0,a.Q_)(s.BU.habit,{syncCloud:{watch:["modalState","curDate","target","percent","surplus","historyOfDay","historyOfWeek","historyOfMonth","markType"]},syncStorage:{watch:["modalState","curDate","target","percent","surplus","historyOfDay","historyOfWeek","historyOfMonth","markType"]},state:()=>({modalShow:!1,modalState:{size:"s",openType:"add",editId:""},...o.VO}),getters:{getStatisticalData(){let t=[];const e=this.curTimeDimension;switch(e){case o.G.week:t=this.historyOfWeek;break;case o.G.month:t=this.historyOfMonth}let i=0,a=0,n=0,s=0;const r={};t.map((t=>{t.target&&(s+=1),i+=t.total,t.done&&(a+=1);const e=t.category||{},o=Object.keys(e);for(const t of o)r[t]=(r[t]||0)+(e[t]||0)})),i&&s&&(n=Math.round(i/s));const l=[{icon:"sum_icon",title:"总数",iconBgColor:"#A69ECF",unit:i>1e3?"L":"ml",value:i>1e3?(i/1e3).toFixed(2):i},{icon:"average_icon",title:"平均",iconBgColor:"#DAB99E",unit:n>1e3?"L":"ml",value:n>1e3?(n/1e3).toFixed(2):n},{icon:"week_icon",title:e===o.G.week?"本周达标":"本月达标",iconBgColor:"#96AEC6",unit:"天",value:a},{icon:"continuous_icon",title:"记录天数",iconBgColor:"#83BEA9",unit:"天",value:s}],c=Object.keys(r);for(const t of c){const e=o.Sr.find((e=>e.type==t)),i=r[t]||0;i>0&&l.push({...e,title:null==e?void 0:e.name,unit:i>1e3?"L":"ml",value:i>1e3?(i/1e3).toFixed(2):i})}return l},getHistoryOfDayList(){const t={};this.historyOfDay.map((e=>{const i=c()(e.time).hour();t[i]=(t[i]||0)+e.num}));return[...Array(24)].map(((e,i)=>({time:i,value:t[i]||0})))}},actions:{openModal(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.modalState=t,this.setModal(!0),this.onlyShowGuidePageTwo=e},setModal(t){h.G.setStatus(n.Rm.habit,t),this.modalShow=t,t||(this.setShowMenuModal(!1),this.setAddPopupShow(!1))},setCurTimeDimension(t){this.curTimeDimension=t},setAddPopupShow(t){this.addPopupShow=t},setShowMenuModal(t){this.menuModalShow=t},setTarget(t){this.target=t,this.setSurplus(t-this.percent),this.updateHistroy({num:0,type:o.MV.water,time:Date.now()})},setPercent(t){this.curDate=Date.now(),this.percent=t,this.setSurplus(this.target-t)},setSurplus(t){this.surplus=t<0?0:t},updateHistroy(t){t.num&&this.addHistoryOfDay(t),this.updateHistoryOfWeek(t),this.updateHistoryOfMonth(t)},updateHistoryOfWeek(t){let e=c()().day();e=0==e?7:e;const i=this.percent,a=this.target,o=t.type,n=t.num;if(0==this.historyOfWeek.length){const n=0==e?7:e;for(let e=1;e<n;e++)this.historyOfWeek.push({type:"week",target:0,time:e,done:!1,total:0,category:{[o]:t.num}});this.historyOfWeek.push({type:"week",target:a,time:e,done:i>=a,total:i,category:{[o]:t.num}});for(let e=n+1;e<=7;e++)this.historyOfWeek.push({type:"week",target:0,time:7==e?0:e,done:!1,total:0,category:{[o]:t.num}})}else{const t=this.historyOfWeek.findIndex((t=>t.time==e));t>-1&&(this.historyOfWeek[t].target=a,this.historyOfWeek[t].done=i>=a,this.historyOfWeek[t].total=i,this.historyOfWeek[t].category[o]=(this.historyOfWeek[t].category[o]||0)+n)}},updateHistoryOfMonth(t){const e=c()().date(),i=this.percent,a=this.target,o=t.type,n=t.num;if(0==this.historyOfMonth.length){for(let i=1;i<e;i++)this.historyOfMonth.push({type:"month",target:0,time:i,done:!1,total:0,category:{[o]:t.num}});this.historyOfMonth.push({type:"month",target:a,time:e,done:i>=a,total:i,category:{[o]:t.num}});for(let i=e+1;i<=c()().daysInMonth();i++)this.historyOfMonth.push({type:"month",target:0,time:i,done:!1,total:0,category:{[o]:t.num}})}else{const t=this.historyOfMonth.findIndex((t=>t.time==e));t>-1&&(this.historyOfMonth[t].target=a,this.historyOfMonth[t].done=i>=a,this.historyOfMonth[t].total=i,this.historyOfMonth[t].category[o]=(this.historyOfMonth[t].category[o]||0)+n)}},getDrinksCategory:t=>o.Sr.find((e=>e.type===t)),getCategoryIcon(t){const e=this.getDrinksCategory(t);return null==e?void 0:e.icon},getCategoryIconBg(t){const e=this.getDrinksCategory(t);return null==e?void 0:e.iconBgColor},getCategoryName(t){const e=this.getDrinksCategory(t);return null==e?void 0:e.name},addHistoryOfDay(t){this.historyOfDay.unshift(t)},check(){if(c()().isAfter(this.curDate,"month")){const t=[];for(let e=1;e<=c()().daysInMonth();e++)t.push({type:"month",target:0,time:e,done:!1,total:0,category:{[o.MV.water]:0}});this.historyOfMonth=t||[]}if(c()().isAfter(this.curDate,"week")){const t=[];for(let e=1;e<=7;e++)t.push({type:"week",target:0,time:e,done:!1,total:0,category:{[o.MV.water]:0}});this.historyOfWeek=t||[]}c()().isAfter(this.curDate,"day")&&(this.setPercent(0),this.historyOfDay=[])},drinking(t){this.target&&(this.check(),this.setPercent(this.percent+t.capacity),this.updateHistroy({num:t.capacity,type:t.category,time:Date.now()}))},setMarkType(t){this.markType=t},saveWidgetData(){if(this.onlyShowGuidePageTwo)return;const t=(0,r.i)();"add"===this.modalState.openType||"preview"===this.modalState.openType?t.saveIcon({type:"widget",name:g.title,widgetSize:this.modalState.size,widgetName:g.name,origin:"add",widgetData:{...this.$state,target:this.target}}):"edit"===this.modalState.openType&&t.saveWidgetData(this.modalState.editId,this.$state)}}})},35367:(t,e,i)=>{let a;i.d(e,{G:()=>n,MV:()=>a,Sr:()=>o,VO:()=>c,tn:()=>r,yD:()=>l,zo:()=>s}),function(t){t.water="Water",t.coffee="Coffee",t.juice="Juice",t.soup="Soup",t.milk="Milk",t.fizzy="Fizzy",t.tea="Tea"}(a||(a={}));const o=[{icon:"coffee_icon",type:a.coffee,iconBgColor:"#87472C",fontColor:"#9E7261",name:"咖啡"},{icon:"tea_icon",type:a.tea,iconBgColor:"#61AD32",fontColor:"#65A656",name:"茶"},{icon:"fizzy_drink_icon",type:a.fizzy,iconBgColor:"#D4875C",fontColor:"#D4875C",name:"气泡水"},{icon:"milk_icon",type:a.milk,iconBgColor:"#81BDFF",fontColor:"#4A7AFF",name:"牛奶"},{icon:"soup_icon",type:a.soup,iconBgColor:"#FF7D46",fontColor:"#D4875C",name:"汤"},{icon:"juice_icon",type:a.juice,iconBgColor:"#BCCE3D",fontColor:"#BCCE3D",name:"果汁"},{icon:"water_icon",type:a.water,iconBgColor:"#27DBA7",fontColor:"#27DBA7",name:"水"}];let n;!function(t){t.day="d",t.week="w",t.month="m"}(n||(n={}));const s=[{label:"日",value:n.day},{label:"周",value:n.week},{label:"月",value:n.month}],r={bgColor:"#FFFFFF",size:44,showPercent:!1},l={height:150,width:280,bgColor:"#27DBA7",fontColor:"#FFFFFF",defBarColor:"#10C591",checkeBarColor:"#FFFFFF"},c={target:0,curDate:0,percent:0,surplus:0,historyOfDay:[],historyOfWeek:[],historyOfMonth:[],markType:"men",curTimeDimension:n.day,addPopupShow:!1,menuModalShow:!1,onlyShowGuidePageTwo:!1}},37334:t=>{t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+5re75YqgPC90aXRsZT4KICAgIDxnIGlkPSLpobXpnaItMSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Ijku5bCP57uE5Lu2LV8t5Lmg5oOv5YW75oiQIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTg0LjAwMDAwMCwgLTI1NS4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9InNtYWxsX+Wkp+Wbvuagh+aooeW8jyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDAuMDAwMDAwLCAyMDAuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0i5re75YqgIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNDQuMDAwMDAwLCA1NS4wMDAwMDApIj4KICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRkZGRkZGIiBvcGFjaXR5PSIwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMTIiIGhlaWdodD0iMTIiPjwvcmVjdD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNiwyIEM2LjU1MjI4NDc1LDIgNywyLjQ0NzcxNTI1IDcsMyBMNyw1IEw5LDUgQzkuNTUyMjg0NzUsNSAxMCw1LjQ0NzcxNTI1IDEwLDYgQzEwLDYuNTUyMjg0NzUgOS41NTIyODQ3NSw3IDksNyBMNyw3IEw3LDkgQzcsOS41NTIyODQ3NSA2LjU1MjI4NDc1LDEwIDYsMTAgQzUuNDQ3NzE1MjUsMTAgNSw5LjU1MjI4NDc1IDUsOSBMNSw3IEwzLDcgQzIuNDQ3NzE1MjUsNyAyLDYuNTUyMjg0NzUgMiw2IEMyLDUuNDQ3NzE1MjUgMi40NDc3MTUyNSw1IDMsNSBMNSw1IEw1LDMgQzUsMi40NDc3MTUyNSA1LjQ0NzcxNTI1LDIgNiwyIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMyRkU1QjAiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+"}}]);