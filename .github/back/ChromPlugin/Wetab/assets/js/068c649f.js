"use strict";(globalThis.webpackChunkinfinity_hitab_client=globalThis.webpackChunkinfinity_hitab_client||[]).push([[4118,1261,96],{31261:(e,l,a)=>{a.r(l),a.d(l,{default:()=>i});var t=a(35427),r=a(57268),o=a(94209);const i=(0,r.aZ)({__name:"userinfo-dialog-cancel-button",setup(e){const l=(0,r.f3)("changeShow"),a=()=>{l(!1)};return(e,l)=>{const i=t.Z;return(0,r.wg)(),(0,r.j4)(i,{type:"main",class:"bg-color-white dark:bg-opacity-20",onClick:a},{default:(0,r.w5)((()=>[(0,r.Uk)((0,o.toDisplayString)("取消"),1)])),_:1})}}})},60096:(e,l,a)=>{a.r(l),a.d(l,{default:()=>v});var t=a(57268),r=a(94209),o=a(29445);const i={class:"h-full pb-[24px]"},s={class:"flex h-full flex-col"},u={class:"mb-[24px] h-[44px] flex-shrink-0 border-b-[1px] border-color-m2 border-opacity-[0.06] px-[24px] text-center text-[16px] leading-[44px] text-color-t1"},d={class:"flex-1 overflow-hidden px-[24px]"},n={key:0,class:"mt-[24px] flex-shrink-0 px-[24px]"},v=(0,t.aZ)({__name:"userinfo-dialog-template",props:{title:null,isScroll:{type:Boolean,default:!0}},setup(e){const l=e,a=(0,t.Rr)();return(e,v)=>((0,t.wg)(),(0,t.iD)("div",i,[(0,t._)("div",s,[(0,t._)("div",u,(0,r.toDisplayString)(l.title),1),(0,t._)("div",d,[(0,t._)("div",{class:(0,r.normalizeClass)(["h-full",{"hi-scroll":l.isScroll}])},[(0,t.WI)(e.$slots,"default")],2)]),(0,o.SU)(a).footer?((0,t.wg)(),(0,t.iD)("div",n,[(0,t.WI)(e.$slots,"footer")])):(0,t.kq)("",!0)])]))}})},74118:(e,l,a)=>{a.r(l),a.d(l,{default:()=>W});var t=a(70308),r=a(35427),o=a(61694),i=a(83218),s=a(70581),u=a(88265),d=a(57268),n=a(94209),v=a(29445),p=a(60096),m=a(31261),c=a(18666),f=a(88793),w=a(24118),h=a.n(w),g=a(74003),x=a(50344),_=a(22140);const y={class:"flex h-full flex-col"},b={class:"mb-[20px] flex-shrink-0 text-[14px] text-color-t2"},C={class:"flex-1 overflow-hidden"},k=["src"],W=(0,d.aZ)({__name:"change-email",setup(e){const l=(0,_.useUserStore)(),a=(0,d.f3)("changeShow"),w=(0,v.iH)("verify-password"),W=(0,v.qj)({password:{value:"",props:{type:"password",placeholder:"密码"}}}),S={password:c.dZ},Z=(0,v.iH)(Date.now()),H=(0,d.Fl)((()=>`${g.H}verify/image?i-branch=zh&type=modify_email&t=${Z.value}`)),U=()=>{Z.value=Date.now()},D=(0,v.iH)(null),$={text:"下一步",async handler(){const[e]=await(0,f.Gv)({password:h()(W.password.value)});e?D.value.setErrorMsg(e):w.value="input-email"}},E=(0,v.qj)({email:{value:"",props:{placeholder:"邮箱"}},imgCode:{value:"",props:{placeholder:"图片验证码",rawAttrs:{maxlength:4}}},verifyCode:{value:"",props:{placeholder:"邮箱验证码",rawAttrs:{maxlength:6}}}}),I={email:c.Tt,imgCode:[{validator:e=>4===e.trim().length,message:"图片验证码必须有4位"}],verifyCode:[{validator:e=>6===e.trim().length,message:"邮箱验证码必须有6位"}]},M=(0,v.iH)(null),T={text:"完成",async handler(){const[e]=await(0,f.oq)({email:E.email.value,emailCode:E.verifyCode.value});var t;e?null===(t=M.value)||void 0===t||t.setErrorMsg("验证码错误"):(l.user.email=E.email.value,l.user={...l.user},a(!1))}},G=(0,v.iH)(!0),j=(0,v.iH)("发送"),q=e=>{G.value=!!e||!E.imgCode.value},z=e=>{G.value=!!e||!E.email.value};let A,O=60;const V=()=>{if(j.value="重新发送"+O,O--,-1===O)return j.value="发送",A=60,void(G.value=!1);A=(0,x.delay)(V,1e3)},B=(0,v.iH)(null),F=(0,v.iH)(null),R=async()=>{var e,l;null===(e=F.value)||void 0===e||e.setErrorMsg(""),null===(l=B.value)||void 0===l||l.setErrorMsg(""),G.value=!0,clearTimeout(A),O=60,V();const[a]=await(0,f.Cz)({email:E.email.value,type:"modify_email",imgCode:E.imgCode.value});var t,r;return"验证码错误"===a?(G.value=!1,j.value="发送",clearTimeout(A),O=60,void(null===(t=F.value)||void 0===t||t.setErrorMsg("验证码错误"))):"账号已存在"===a?(G.value=!1,j.value="发送",clearTimeout(A),O=60,void(null===(r=B.value)||void 0===r||r.setErrorMsg("账号已存在"))):void 0};return(e,l)=>{const a=u.Z,c=s.Z,f=i.Z,h=o.Z,g=r.Z,x=t.Z;return(0,d.wg)(),(0,d.j4)(p.default,{title:"更改邮箱","is-scroll":!1},{default:(0,d.w5)((()=>[(0,d.Wm)(x,{variable:w.value,class:"h-[247px]"},{default:(0,d.w5)((()=>[(0,d.Wm)(h,{value:"verify-password"},{default:(0,d.w5)((()=>[(0,d._)("div",y,[(0,d._)("span",b,(0,n.toDisplayString)("为了您的帐户安全，请输入您的帐户密码"),1),(0,d._)("div",C,[(0,d.Wm)(f,{"content-class":"flex-1",model:W,rules:S,"submit-btn-attrs":$},{default:(0,d.w5)((()=>[(0,d.Wm)(c,{path:"password"},{default:(0,d.w5)((()=>[(0,d.Wm)(a,(0,d.dG)({ref_key:"$passwordInput",ref:D,value:W.password.value,"onUpdate:value":l[0]||(l[0]=e=>W.password.value=e)},W.password.props),null,16,["value"])])),_:1})])),"form-btn":(0,d.w5)((()=>[(0,d.Wm)(m.default)])),_:1},8,["model"])])])])),_:1}),(0,d.Wm)(h,{value:"input-email"},{default:(0,d.w5)((()=>[(0,d.Wm)(f,{model:E,rules:I,"submit-btn-attrs":T},{default:(0,d.w5)((()=>[(0,d.Wm)(c,{path:"email",onOnValidate:q},{default:(0,d.w5)((()=>[(0,d.Wm)(a,(0,d.dG)({ref_key:"$emailInput",ref:B,value:E.email.value,"onUpdate:value":l[1]||(l[1]=e=>E.email.value=e)},E.email.props),null,16,["value"])])),_:1}),(0,d.Wm)(c,{path:"imgCode",onOnValidate:z},{default:(0,d.w5)((()=>[(0,d.Wm)(a,(0,d.dG)({ref_key:"$imgCodeInput",ref:F},E.imgCode.props,{value:E.imgCode.value,"onUpdate:value":l[2]||(l[2]=e=>E.imgCode.value=e)}),{"outer-right":(0,d.w5)((()=>[(0,d._)("div",{class:"h-[44px] w-[100px] cursor-pointer rounded-[8px] bg-color-t4",onClick:U},[(0,d._)("img",{src:(0,v.SU)(H),class:"h-full"},null,8,k)])])),_:1},16,["value"])])),_:1}),(0,d.Wm)(c,{path:"verifyCode"},{default:(0,d.w5)((()=>[(0,d.Wm)(a,(0,d.dG)({ref_key:"$emailCodeInput",ref:M,value:E.verifyCode.value,"onUpdate:value":l[3]||(l[3]=e=>E.verifyCode.value=e)},E.verifyCode.props),{"inner-right":(0,d.w5)((()=>[(0,d.Wm)(g,{type:"main",size:"medium",disabled:G.value,"text-color":"color-primary",class:"h-full",onClick:R},{default:(0,d.w5)((()=>[(0,d.Uk)((0,n.toDisplayString)(j.value),1)])),_:1},8,["disabled"])])),_:1},16,["value"])])),_:1})])),"form-btn":(0,d.w5)((()=>[(0,d.Wm)(m.default)])),_:1},8,["model"])])),_:1})])),_:1},8,["variable"])])),_:1},8,["title"])}}})}}]);