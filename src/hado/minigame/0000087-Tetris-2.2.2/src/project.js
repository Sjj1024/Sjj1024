window.__require=function t(c,e,o){function r(i,a){if(!e[i]){if(!c[i]){var s=i.split("/");if(s=s[s.length-1],!c[s]){var u="function"==typeof __require&&__require;if(!a&&u)return u(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+i+"'")}}var h=e[i]={exports:{}};c[i][0].call(h.exports,function(t){return r(c[i][1][t]||t)},h,h.exports,t,c,e,o)}return e[i].exports}for(var n="function"==typeof __require&&__require,i=0;i<o.length;i++)r(o[i]);return r}({"config-tool":[function(t,c,e){"use strict";cc._RF.push(c,"be8f2VLg8pCoJ/bChpa4GQh","config-tool"),Object.defineProperty(e,"__esModule",{value:!0});var o=cc._decorator,r=o.ccclass,n=o.property,i=function(t){function c(){var c=null!==t&&t.apply(this,arguments)||this;return c.buttons=void 0,c.clickData=[],c}return __extends(c,t),c.prototype.onLoad=function(){this.initData(),this.registerEvent(),this.clear()},c.prototype.initData=function(){for(var t=0;t<4;t++){this.clickData[t]=[];for(var c=0;c<4;c++)this.clickData[t][c]=!1}},c.prototype.outData=function(){for(var t=[],c=0;c<4;c++)for(var e=0;e<4;e++)this.clickData[c][e]&&t.push(cc.v2(c,e));var o="[";t.forEach(function(c,e){var r=c.x-1,n=c.y-1;o+="cc.v2("+r+", "+n+")",e!==t.length-1&&(o+=", ")}),o+="]",cc.log(o)},c.prototype.clear=function(){var t=this;this.buttons.children.forEach(function(c,e){c.children[0].color=cc.color(220,220,220);var o=t.indexToRowCol(e);t.clickData[o.x][o.y]=!1})},c.prototype.onButtonClick=function(t,c){c.children[0].color=cc.Color.GREEN;var e=this.indexToRowCol(t);this.clickData[e.x][e.y]=!0},c.prototype.registerEvent=function(){var t=this;this.buttons.children.forEach(function(c,e){c.on(cc.Node.EventType.TOUCH_END,function(c){t.onButtonClick(e,c.target)})})},c.prototype.indexToRowCol=function(t){var c=Math.floor(t/4),e=t%4;return cc.v2(c,e)},__decorate([n(cc.Node)],c.prototype,"buttons",void 0),c=__decorate([r],c)}(cc.Component);e.default=i,cc._RF.pop()},{}],config:[function(t,c,e){"use strict";cc._RF.push(c,"d436cfLvcBFOZas0mcYONrI","config"),Object.defineProperty(e,"__esModule",{value:!0}),e.config={blockWidth:90,blockHeight:80,itemWidth:78,itemHeight:67,row:12,col:7,startPos:cc.v2(1,3),shape1:[[cc.v2(0,-1),cc.v2(0,0),cc.v2(0,1),cc.v2(0,2)],[cc.v2(-1,0),cc.v2(0,0),cc.v2(1,0),cc.v2(2,0)],[cc.v2(0,-1),cc.v2(0,0),cc.v2(0,1),cc.v2(0,2)],[cc.v2(-1,0),cc.v2(0,0),cc.v2(1,0),cc.v2(2,0)]],shape2:[[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,-1),cc.v2(0,0)],[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,-1),cc.v2(0,0)],[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,-1),cc.v2(0,0)],[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,-1),cc.v2(0,0)]],shape3:[[cc.v2(0,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(0,1)],[cc.v2(1,0),cc.v2(-1,0),cc.v2(0,0),cc.v2(0,1)],[cc.v2(0,-1),cc.v2(1,0),cc.v2(0,0),cc.v2(0,1)],[cc.v2(0,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(1,0)]],shape4:[[cc.v2(-1,0),cc.v2(0,0),cc.v2(1,0),cc.v2(1,1)],[cc.v2(1,-1),cc.v2(0,-1),cc.v2(0,0),cc.v2(0,1)],[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(1,0)],[cc.v2(-1,1),cc.v2(0,-1),cc.v2(0,0),cc.v2(0,1)]],shape5:[[cc.v2(-1,0),cc.v2(0,0),cc.v2(1,0),cc.v2(1,-1)],[cc.v2(-1,-1),cc.v2(0,-1),cc.v2(0,0),cc.v2(0,1)],[cc.v2(-1,0),cc.v2(-1,1),cc.v2(0,0),cc.v2(1,0)],[cc.v2(0,-1),cc.v2(0,0),cc.v2(0,1),cc.v2(1,1)]],shape6:[[cc.v2(-1,0),cc.v2(-1,1),cc.v2(0,-1),cc.v2(0,0)],[cc.v2(-1,-1),cc.v2(0,-1),cc.v2(0,0),cc.v2(1,0)],[cc.v2(-1,0),cc.v2(-1,1),cc.v2(0,-1),cc.v2(0,0)],[cc.v2(-1,-1),cc.v2(0,-1),cc.v2(0,0),cc.v2(1,0)]],shape7:[[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(0,1)],[cc.v2(1,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(0,-1)],[cc.v2(-1,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(0,1)],[cc.v2(1,-1),cc.v2(-1,0),cc.v2(0,0),cc.v2(0,-1)]]},cc._RF.pop()},{}],enum:[function(t,c,e){"use strict";cc._RF.push(c,"3f519Rww+BNCqgfId5+X30+","enum"),Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.NULL=0]="NULL",t[t.Color1=1]="Color1",t[t.Color2=2]="Color2",t[t.Color3=3]="Color3",t[t.Color4=4]="Color4",t[t.Color5=5]="Color5",t[t.Color6=6]="Color6",t[t.Color7=7]="Color7"}(e.ItemColor||(e.ItemColor={})),function(t){t.UP="touch-up",t.DOWN="touch-down",t.LEFT="touch-left",t.RIGHT="touch-right"}(e.TouchEvent||(e.TouchEvent={})),function(t){t.BGM="bgm",t.ACTION="action",t.GAME_OVER="over",t.ELIMINATE="eliminate"}(e.MusicEvent||(e.MusicEvent={})),function(t){t.Canvas="Canvas",t.Music="Music"}(e.NodeUrl||(e.NodeUrl={})),cc._RF.pop()},{}],main:[function(t,c,e){"use strict";cc._RF.push(c,"52073YquUJE1Zi+6Jw3DGup","main"),Object.defineProperty(e,"__esModule",{value:!0});var o=t("./config"),r=t("./render"),n=t("./enum"),i=cc._decorator,a=i.ccclass,s=i.property,u=function(t){function c(){var c=null!==t&&t.apply(this,arguments)||this;return c.renderClass=void 0,c.startPanel=void 0,c.dataArray=[],c.currentShape={center:cc.v2(0,0),index:0,color:n.ItemColor.NULL},c.time=0,c.isOpen=!1,c}return __extends(c,t),c.prototype.onLoad=function(){this.registerEvent()},c.prototype.start=function(){cc.find(n.NodeUrl.Music).emit(n.MusicEvent.BGM)},c.prototype.registerEvent=function(){var t=this;this.node.on(n.TouchEvent.UP,function(){t.changeCurrentShapeIndex()},this),this.node.on(n.TouchEvent.DOWN,function(){t.changeCurrentShapePos(cc.v2(1,0))},this),this.node.on(n.TouchEvent.LEFT,function(){t.changeCurrentShapePos(cc.v2(0,-1))},this),this.node.on(n.TouchEvent.RIGHT,function(){t.changeCurrentShapePos(cc.v2(0,1))},this)},c.prototype.gameStart=function(){this.startPanel.active=!1,this.initData(),this.render(),this.randomOneShape(),this.isOpen=!0},c.prototype.initData=function(){for(var t=0;t<o.config.row;t++){this.dataArray[t]=[];for(var c=0;c<o.config.col;c++)this.dataArray[t][c]=n.ItemColor.NULL}},c.prototype.randomOneShape=function(){var t=this;this.currentShape.center.set(o.config.startPos),this.currentShape.color=Math.floor(1+7*Math.random()),this.currentShape.index=Math.floor(4*Math.random()),this.isCurrentDataOK(this.currentShape)?this.setCurrentData(this.currentShape):(cc.warn("\u6e38\u620f\u7ed3\u675f"),this.isOpen=!1,this.setCurrentData(this.currentShape),cc.find(n.NodeUrl.Music).emit(n.MusicEvent.GAME_OVER),this.scheduleOnce(function(){t.startPanel.active=!0},2))},c.prototype.clearCurrentData=function(t){var c=this,e=t.center,r=t.color,i=t.index,a="shape"+r;o.config[a][i].forEach(function(t){var o=e.x+t.x,r=e.y+t.y;c.dataArray[o][r]=n.ItemColor.NULL})},c.prototype.setCurrentData=function(t){var c=this,e=t.center,r=t.color,n=t.index,i="shape"+r;o.config[i][n].forEach(function(t){var o=e.x+t.x,n=e.y+t.y;c.dataArray[o][n]=r}),this.render()},c.prototype.isCurrentDataOK=function(t){for(var c=t.center,e=t.color,r=t.index,i="shape"+e,a=o.config[i][r],s=0;s<a.length;s++){var u=c.x+a[s].x;if(u<0||u>=o.config.row)return!1;var h=c.y+a[s].y;if(h<0||h>=o.config.col)return!1;if(this.dataArray[u][h]!==n.ItemColor.NULL)return!1}return!0},c.prototype.changeCurrentShapeIndex=function(){this.clearCurrentData(this.currentShape),this.currentShape.index+=3===this.currentShape.index?-3:1,this.isCurrentDataOK(this.currentShape)?(this.setCurrentData(this.currentShape),cc.find(n.NodeUrl.Music).emit(n.MusicEvent.ACTION)):(cc.warn("\u64cd\u4f5c\u4e0d\u5408\u7406"),this.currentShape.index+=0===this.currentShape.index?3:-1)},c.prototype.changeCurrentShapePos=function(t){this.clearCurrentData(this.currentShape),this.currentShape.center.x+=t.x,this.currentShape.center.y+=t.y,this.isCurrentDataOK(this.currentShape)?this.setCurrentData(this.currentShape):(cc.warn("\u64cd\u4f5c\u4e0d\u5408\u7406"),this.currentShape.center.x-=t.x,this.currentShape.center.y-=t.y)},c.prototype.checkLines=function(){for(var t=o.config.row-1,c=!1;0!==t;){for(var e=!0,r=0;r<o.config.col;r++)this.dataArray[t][r]===n.ItemColor.NULL&&(e=!1);if(e){c=!0;for(var i=t;i>0;i--)for(var a=0;a<o.config.col;a++)this.dataArray[i][a]=this.dataArray[i-1][a]}else t--}c&&cc.find(n.NodeUrl.Music).emit(n.MusicEvent.ELIMINATE)},c.prototype.autoDown=function(){this.clearCurrentData(this.currentShape),this.currentShape.center.x+=1,this.isCurrentDataOK(this.currentShape)?this.setCurrentData(this.currentShape):(cc.warn("\u65e0\u6cd5\u4e0b\u79fb\u52a8\uff0c\u4e0b\u4e00\u4e2a"),this.currentShape.center.x-=1,this.setCurrentData(this.currentShape),this.checkLines(),this.randomOneShape())},c.prototype.update=function(t){this.isOpen&&(this.time+=t,this.time>1&&(this.time=0,this.autoDown()))},c.prototype.render=function(){this.renderClass.render(this.dataArray)},__decorate([s(r.default)],c.prototype,"renderClass",void 0),__decorate([s(cc.Node)],c.prototype,"startPanel",void 0),c=__decorate([a],c)}(cc.Component);e.default=u,cc._RF.pop()},{"./config":"config","./enum":"enum","./render":"render"}],music:[function(t,c,e){"use strict";cc._RF.push(c,"3191eohAoRNvoRxvyeY4GTM","music"),Object.defineProperty(e,"__esModule",{value:!0});var o=t("./enum"),r=cc._decorator,n=r.ccclass,i=r.property,a=function(t){function c(){var c=null!==t&&t.apply(this,arguments)||this;return c.bgm=void 0,c.effects=[],c}return __extends(c,t),c.prototype.onLoad=function(){this.registerEvent()},c.prototype.registerEvent=function(){var t=this;this.node.on(o.MusicEvent.BGM,function(){return cc.audioEngine.play(t.bgm,!0,.3)},this),this.node.on(o.MusicEvent.ACTION,function(){return cc.audioEngine.playEffect(t.effects[0],!1)},this),this.node.on(o.MusicEvent.GAME_OVER,function(){return cc.audioEngine.playEffect(t.effects[1],!1)},this),this.node.on(o.MusicEvent.ELIMINATE,function(){return cc.audioEngine.playEffect(t.effects[2],!1)},this)},__decorate([i({type:cc.AudioClip})],c.prototype,"bgm",void 0),__decorate([i({type:[cc.AudioClip]})],c.prototype,"effects",void 0),c=__decorate([n],c)}(cc.Component);e.default=a,cc._RF.pop()},{"./enum":"enum"}],render:[function(t,c,e){"use strict";cc._RF.push(c,"af5cbAjVx9L459whaT0CJ9E","render"),Object.defineProperty(e,"__esModule",{value:!0});var o=t("./config"),r=cc._decorator,n=r.ccclass,i=r.property,a=function(t){function c(){var c=null!==t&&t.apply(this,arguments)||this;return c.item=void 0,c.itemSpriteFrames=[],c.itemArray=[],c}return __extends(c,t),c.prototype.onLoad=function(){this.init()},c.prototype.init=function(){for(var t=o.config.row*o.config.blockHeight,c=o.config.col*o.config.blockWidth,e=0;e<o.config.row;e++){this.itemArray[e]=[];for(var r=0;r<o.config.col;r++){var n=-c/2+o.config.blockWidth/2+r*o.config.blockWidth,i=t/2-o.config.blockHeight/2-e*o.config.blockHeight,a=this.createItem(n,i);this.itemArray[e][r]=a}}},c.prototype.render=function(t){for(var c=0;c<o.config.row;c++)for(var e=0;e<o.config.col;e++){var r=t[c][e];this.itemArray[c][e].getComponent(cc.Sprite).spriteFrame=this.itemSpriteFrames[r-1]}},c.prototype.createItem=function(t,c){var e=cc.instantiate(this.item);return this.node.addChild(e),e.setPosition(t,c),e.setContentSize(o.config.itemWidth,o.config.itemHeight),e},__decorate([i(cc.Prefab)],c.prototype,"item",void 0),__decorate([i([cc.SpriteFrame])],c.prototype,"itemSpriteFrames",void 0),c=__decorate([n],c)}(cc.Component);e.default=a,cc._RF.pop()},{"./config":"config"}],touch:[function(t,c,e){"use strict";cc._RF.push(c,"f95c8LJcWhP+IxmovtHpMFw","touch"),Object.defineProperty(e,"__esModule",{value:!0});var o=t("./enum"),r=cc._decorator,n=r.ccclass,i=r.property,a=function(t){function c(){var c=null!==t&&t.apply(this,arguments)||this;return c.aimNode=void 0,c}return __extends(c,t),c.prototype.onLoad=function(){this.registerEvent()},c.prototype.registerEvent=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_END,function(c){var e=c.getStartLocation(),o=c.getLocation().sub(e),r=Math.atan2(o.y,o.x),n=cc.misc.radiansToDegrees(r),i=Math.floor(n/45);t.emitEventByIndex(i)},this)},c.prototype.emitEventByIndex=function(t){0===t||-1===t?this.aimNode.emit(o.TouchEvent.RIGHT):1===t||2===t?this.aimNode.emit(o.TouchEvent.UP):-2===t||-3===t?this.aimNode.emit(o.TouchEvent.DOWN):-4===t||3===t||4===t?this.aimNode.emit(o.TouchEvent.LEFT):cc.error("\u65e0\u6b64\u65b9\u5411"+t)},__decorate([i(cc.Node)],c.prototype,"aimNode",void 0),c=__decorate([n],c)}(cc.Component);e.default=a,cc._RF.pop()},{"./enum":"enum"}]},{},["config","enum","main","music","render","touch","config-tool"]);